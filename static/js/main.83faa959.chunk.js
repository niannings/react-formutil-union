(this["webpackJsonpreact-formutil-union-example"]=this["webpackJsonpreact-formutil-union-example"]||[]).push([[0],{135:function(e,t,n){e.exports=n(218)},136:function(e,t,n){},214:function(e,t,n){},215:function(e,t,n){},218:function(e,t,n){"use strict";n.r(t);n(136);var r=n(0),a=n.n(r),u=n(29),c=n.n(u),o=n(73),i=n(70),l=n(226),s=n(130),f=n(227),m=n(31),v=n(40);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var y=0;var h=Object(r.createContext)((function(){return{}})),E=function(){function e(){this.pool={},this.oncePool={}}var t=e.prototype;return t.listen=function(e,t,n,r){var a=0===e?this.pool:this.oncePool,u=a[t];u||(u=a[t]={queue:[],taged:{}}),r?u.taged[r]=n:u.queue.push(n)},t.unlisten=function(e,t){var n=[this.pool,this.oncePool];return"string"===typeof t?n.reduce((function(n,r){if(e in r){var a=r[e];t in a.taged&&(delete a.taged[t],n--)}return n}),2):n.reduce((function(n,r){if(e in r){var a=r[e],u=a.queue.indexOf(t);u>-1&&(a.queue.splice(u,1),n+=a.queue.length)}return n}),0)},t.has=function(e,t){var n=[this.pool,this.oncePool];return"string"===typeof t?n.some((function(n){return e in n&&t in n[e].taged})):n.some((function(n){return e in n&&n[e].queue.includes(t)}))},t.on=function(e,t,n){this.listen(0,e,t,n)},t.once=function(e,t,n){this.listen(1,e,t,n)},t.emit=function(e,t){[this.pool,this.oncePool].forEach((function(n){var r=[];e in n&&(n[e].taged&&r.push.apply(r,Object.values(n[e].taged)),n[e].queue&&r.push.apply(r,n[e].queue)),r.forEach((function(e){return e(t)}))})),e in this.oncePool&&delete this.oncePool[e]},e}();function O(){return Object(r.useContext)(h)()}function g(){var e=O();Object(r.useMemo)((function(){if(!e.current)throw new Error("useFormUnion \u53ea\u80fd\u5728UnionForm\u7ec4\u4ef6\u4f5c\u7528\u57df\u4e0b\u4f7f\u7528")}),[e]);var t=Object(r.useRef)(),n=Object(r.useRef)(),a=Object(r.useRef)(),u=function(){var e=Object(r.useState)(0)[1];return Object(r.useCallback)((function(){return e((function(e){return e+1}))}),[])}();Object(r.useMemo)((function(){t.current=new Set,n.current=("w_"||"")+y++}),[]);var c=Object(r.useCallback)((function(r){var a=e.current.core,c=function(e){var r;null===(r=t.current)||void 0===r||r.add(e),a.deps.add(e),a.eventBus.on(e,u,n.current)};"string"===typeof r?c(r):r.forEach(c)}),[e,u]),o=Object(r.useCallback)((function(t){var r=e.current.core,a=function(e){0===r.eventBus.unlisten(e,n.current)&&r.deps.delete(e)};"string"===typeof t?a(t):t.forEach(a)}),[e]);return Object(r.useEffect)((function(){var t,r,u,c=e.current,o=c.core,i=c.utils;if(o.deps.size>0){for(var l,s=o.eventBus,f=i.getValues(),m={},v=b(o.deps);!(l=v()).done;){var d=l.value;m[d]=(u=f,d.split(/[.[\]]/g).filter(Boolean).reduce((function(e,t){return null===e||void 0===e?e:e[t]}),u))}(t=m,r=a.current||{},Object.keys(t).filter((function(e){return t[e]!==r[e]}))).forEach((function(e){s.has(e,n.current)||s.emit(e)})),a.current=m}})),Object(r.useEffect)((function(){return function(){for(var e,n=b(t.current);!(e=n()).done;){var r=e.value;o(r)}}}),[o]),{watch:c,noWatch:o}}function j(e,t){var n=O();return Object(r.useMemo)((function(){if(!n.current)throw new Error("useFormUnion \u53ea\u80fd\u5728UnionForm\u7ec4\u4ef6\u4f5c\u7528\u57df\u4e0b\u4f7f\u7528")}),[n]),Object(r.useEffect)((function(){var r=n.current.core;return e&&void 0!==t&&r.collect(t,e),function(){void 0!==t&&r.remove(t)}}),[n,e,t]),d({getForms:function(){return d({},n.current.core.collection)}},n.current.utils,g())}function w(e){var t=e.children,n=e.defaultValues,u=e.type,c=e.keys,o=Object(r.useRef)();Object(r.useMemo)((function(){if(o.current)o.current.core.type=u,o.current.core.defaultValues=n,o.current.core.keys=c;else{var e={};o.current={core:{collection:e,collect:function(t,n){return e[t]=n},remove:function(t){return delete e[t]},deps:new Set,eventBus:new E,type:u,defaultValues:n,keys:c},utils:{getValues:function(){var t={};return"array"===u&&(t=[]),"object"===u?Object.entries(e).reduce((function(e,t){return function(e,t,n){if(function(e){return null!==e&&void 0!==e}(e)&&t){for(var r=t.split(/[.[\]]/g).filter(Boolean),a=r.length,u=1;u<a;){var c=r[u-1],o=r[u];e[c]||(Number.isNaN(+o)?e[c]={}:e[c]=[]),e=e[c],u++}e[r[u-1]]=n}}(e,t[0],t[1].$params),e}),t):Object.entries(e).reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r.$params,e}),t)},getValidStatus:function(){return Object.values(e).every((function(e){return e.$valid}))},batchDirty:function(t){return Object.values(e).forEach((function(e){return e.$batchDirty(t)}))},getFirstError:function(){var t,n;return(Array.isArray(c)?(n=[].concat(c,Object.keys(e)),[].concat(new Set(n))):Object.keys(e)).some((function(n){var r=e[n];return r&&r.$invalid&&"function"===typeof r.$getFirstError&&(t=r.$getFirstError()),null===r||void 0===r?void 0:r.$invalid})),t},getUnionDefaultValues:function(){var e;return d({},null===(e=o.current)||void 0===e?void 0:e.core.defaultValues)}}}}}),[n,c,u]);var i=Object(r.useCallback)((function(){return o}),[]);return a.a.createElement(h.Provider,{value:i},t)}w.withHOC=function(e,t){var n=function(n){var u=d({},t,n),c=u.type,o=u.defaultValues,i=function(e,t){if(null==e)return{};var n,r,a={},u=Object.keys(e);for(r=0;r<u.length;r++)n=u[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(u,["type","defaultValues"]);return a.a.createElement(w,{type:c||"object",defaultValues:o},Object(r.createElement)(e,i))};return n.displayName="FormUnion."+(e.displayName||e.name||"Anonymous"),n};var S=w;n(214);function F(e){var t=e.children,n=e.siderLeft,r=e.siderRight;return a.a.createElement("div",{className:"layout"},n&&a.a.createElement("div",{className:"sider"},n),a.a.createElement("div",{className:"content"},t),r&&a.a.createElement("div",{className:"sider"},r))}n(215);function k(){var e=Object(r.useState)(0),t=Object(o.a)(e,2),n=t[0],u=t[1];return Object(r.useEffect)((function(){!function e(){(function(e){var t=performance.now();return new Promise((function(n){var r,a=0;!function u(){a++,r=requestAnimationFrame(u),performance.now()-t>=e&&(cancelAnimationFrame(r),n(a/(e/1e3)))}()}))})(1e3).then((function(t){u(t),e()})).catch((function(){}))}()}),[]),a.a.createElement("b",{className:"fps",style:{color:n>45?"green":n>30?"orange":"red"}},"FPS:",n)}var A=Object(i.withForm)((function(e){var t=e.index,n=Object(r.useMemo)((function(){return Array(20).fill(0)}),[]);return j(Object(i["useForm"])(),"form_".concat(t)),a.a.createElement(l.a,{gutter:24},n.map((function(e,n){var r=n+20*t;return a.a.createElement(v.a,{span:6,key:n},a.a.createElement(i.FormItem,{label:"\u8f93\u5165-".concat(r),name:"name_".concat(r)},r%2?a.a.createElement(s.a,{size:"small"}):a.a.createElement(f.a,{size:"small"})))})))}));var N=S.withHOC((function(){var e=Object(r.useState)(200),t=Object(o.a)(e,2),n=t[0],u=t[1],c=Object(r.useState)(!1),d=Object(o.a)(c,2),p=d[0],b=d[1],y=Object(r.useMemo)((function(){return Array(n).fill(0)}),[n]);return a.a.createElement(l.a,{gutter:24},a.a.createElement(v.a,{span:11},a.a.createElement(i.Form,null,(function(e){return a.a.createElement(F,{siderLeft:a.a.createElement("span",null,p&&a.a.createElement("pre",null,JSON.stringify(e.$params,null,2)))},a.a.createElement("h2",null,"\u5e38\u89c4\u5199\u6cd5"),a.a.createElement(l.a,{gutter:24},y.map((function(e,t){return a.a.createElement(v.a,{span:6,key:t},a.a.createElement(i.FormItem,{label:"\u8f93\u5165-".concat(t),name:"name_".concat(t)},t%2?a.a.createElement(s.a,{size:"small"}):a.a.createElement(f.a,{size:"small"})))}))))}))),a.a.createElement(v.a,{span:2,style:{background:"#eee",textAlign:"center"}},a.a.createElement(k,null),a.a.createElement("p",{style:{fontSize:12,color:"gray"}},"\u5206\u522b\u5728\u4e24\u8fb9\u8868\u5355\u8f93\u5165\u5e76\u89c2\u5bdfFPS\u53d8\u5316"),a.a.createElement(m.a,{type:"primary",size:"small",onClick:function(){return b((function(e){return!e}))}},p?"\u9690\u85cf":"\u663e\u793a","\u8868\u5355\u72b6\u6001"),a.a.createElement("i",{style:{fontSize:12,color:"gray"}},"\u5f53\u524d\u8868\u5355\u9879\u6570\u91cf (\u8868\u5355\u9879\u5e94\u5927\u4e8e20\u4e14\u80fd\u88ab20\u6574\u9664)\uff1a",n),a.a.createElement(s.a,{size:"small",placeholder:"\u8868\u5355\u9879\u6570",onChange:function(e){var t=+e.target.value;t&&t%20===0&&u(t)}})),a.a.createElement(v.a,{span:11},a.a.createElement(F,{siderRight:a.a.createElement("span",null,p&&a.a.createElement(P,null))},a.a.createElement("h2",null,"\u4f7f\u7528FormUnion"),Array(n/20).fill(0).map((function(e,t){return a.a.createElement(A,{key:t,index:t})}))),a.a.createElement(P,null)))}),{type:"object"});function P(){var e=j(),t=e.watch,n=e.getValues,r=Object.values(n()).reduce((function(e,t){return Object.assign(e,t)}),{});return t("form_0.name_0"),a.a.createElement("pre",null,JSON.stringify(r,null,2))}var V=function(){return a.a.createElement(N,null)};n(216),n(217);c.a.render(a.a.createElement(V,null),document.getElementById("root"))}},[[135,1,2]]]);
//# sourceMappingURL=main.83faa959.chunk.js.map